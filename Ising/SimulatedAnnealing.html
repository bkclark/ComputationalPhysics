
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Extra Credit: Simulated Annealing &#8212; Computing in Physics (Phy446)</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Overview" href="../ML/Overview.html" />
    <link rel="prev" title="Extra Credit: Parallel Tempering" href="ParallelTempering.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Computing in Physics (Phy446)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Setting up
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../GettingStarted.html">
   Getting Setup
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Cellular Automata
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../CellularAutomata/CellularAutomata.html">
   Cellular Automata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CellularAutomata/Sand.html">
   Sand
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CellularAutomata/OtherAutomata.html">
   Other Interesting Automata
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Quantum Computing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../QC/Overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../QC/0-DiracNotation.html">
   Dirac Notation
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../QC/1a-QuantumComputingSimulator.html">
   QC Simulator II
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../QC/1b-QuantumComputingSimulator.html">
     QC Simulator I(abcd)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../QC/NonAtomicGates.html">
   Non-atomic gates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../QC/PhaseEstimation.html">
   Phase estimation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../QC/QFT.html">
   Quantum Fourier Transform
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../QC/Shor-Overview.html">
   Shor’s Algorithm
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../QC/Shor-Classical.html">
     Shor’s Algorithm (classically)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../QC/Shor-Quantum.html">
     Quantum Matrix
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../QC/ModularMultiplication.html">
     Modular Multiplication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../QC/Shor-QuantumCircuit.html">
     Shor’s Algorithm
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Quantum Computing (extensions)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../QC/Gates.html">
   Gates
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../QC/ClassicalGates.html">
     Classical Gates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../QC/ControlledGates.html">
     Controlled Gates
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../QC/Universal.html">
     Gates for any Unitary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../QC/BQPinPSPACE.html">
   BQP in PSPACE
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Ising Model
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="IsingModel.html">
   Simulating an Ising Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Measure.html">
   Measuring the Ising Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="RG.html">
   The Renormalization Group
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ParallelTempering.html">
   Extra Credit: Parallel Tempering
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Extra Credit: Simulated Annealing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ML/Overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ML/Hopfield.html">
   Hopfield Networks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ML/RBM.html">
   Restricted Boltzmann Machines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ML/Diffusion.html">
   Generative Diffusion Models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Topological Insulators
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../TI/Overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../TI/Lattice.html">
   Lattices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../TI/TightBinding.html">
   Tight Binding Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../TI/ChernInsulators.html">
   Topological Insulators
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated Annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#local-optimization">
     Local Optimization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Simulated Annealing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hp-model">
   HP Model
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Extra Credit: Simulated Annealing</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulated-annealing">
   Simulated Annealing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#local-optimization">
     Local Optimization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Simulated Annealing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hp-model">
   HP Model
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="extra-credit-simulated-annealing">
<h1>Extra Credit: Simulated Annealing<a class="headerlink" href="#extra-credit-simulated-annealing" title="Permalink to this headline">#</a></h1>
<div class="tip admonition">
<p class="admonition-title">Extra Credit </p>
<p>This page is <strong>10+10 points extra credit</strong></p>
</div>
<p>The Ising model is useful for lots of things, one of which is helping us learn about optimization.</p>
<p>The goal of optimization is to <strong>extremize</strong> (maximize or minimize) a particular function O, called an objective function, which depends on a bunch of parameters <span class="math notranslate nohighlight">\((p_1,p_2,...,p_n\)</span>). One way to go about this is to compute the objective function’s derivatives with respect to the parameters, <span class="math notranslate nohighlight">\(\partial O/\partial i\)</span>. When fed a particular vector of parameters <span class="math notranslate nohighlight">\(p\)</span>, the derivatives identify the direction in which O changes most significantly. Iteratively “walking” in this direction — a procedure called <strong>gradient descent</strong> (for minimization) — leads to an extremum of <span class="math notranslate nohighlight">\(O\)</span>. Unfortunately this procedure only finds local extrema; it can get you up the nearest hill or down the nearest valley, but there might be a mountain or gorge someplace further away that you’ve missed. Avoiding this situation requires an algorithm that finds global extrema.</p>
<p>In general it is impossible to find global extrema quickly (although we will soon see a way to go about it slowly). More generically, though, there are a number of heurestic algorithms that allow us to find global extrema, many of which are inspired by physics or nature. The most famous of these is simulated annealing. In <strong>simulated annealing</strong> you essentially run a simulation at very high temperature and then slowly cool things down. The intuition behind this is that at high temperatures you will be able to sample the entire landscape of the objective function, and then as you cool down you end up falling into the lowest minima.</p>
<p>In our case, our objective function will be to find the configuration of spins in an Ising model (<em>our parameters</em>) which minimizes the energy (<em>our objective function</em>). In the model that we’ve studied thus far, where all the coefficients <span class="math notranslate nohighlight">\(J\)</span> are the same, this isn’t very interesting (you can probably find the ground state without a computer). On the other hand, if we choose random signs on each of the coefficients, finding the ground state will be hard.</p>
<div class="caution admonition">
<p class="admonition-title">Grading</p>
<p>Modify your Ising model to work with arbitrary coupling constants on each bond.</p>
</div>
<div class="section" id="simulated-annealing">
<h2>Simulated Annealing<a class="headerlink" href="#simulated-annealing" title="Permalink to this headline">#</a></h2>
<div class="section" id="local-optimization">
<h3>Local Optimization<a class="headerlink" href="#local-optimization" title="Permalink to this headline">#</a></h3>
<p>Let’s start with a poor approach to optimization. Start in the configuration where all spins are up. Loop through the spins over and over again, flipping one anytime its opposite orientation reduces the energy. Stop after visiting N sequential spins without having performed any flips. This is a local minimum.</p>
<p>Go ahead and start with various random configurations. Do you get to the same local minima each time? If not, this means that typically you’re not finding global minima.</p>
<div class="caution admonition">
<p class="admonition-title">Grading</p>
<p>On a 20x20 latttice, you need to set up a set of random coupling constants and tried to find minima using local optimization. To do this, you should start with 100 different initial conditions and do local optimization until you can’t decrease the energy any longer. Report how many different minima it finds and how often it finds them.</p>
</div>
</div>
<div class="section" id="id1">
<h3>Simulated Annealing<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>Simulated annealing modifies the above algorithm in a very natural way.  Instead of running at zero temperature (which always goes downhill), in simulated annealing we start by running at a high temperature.  Over time, we slowly decrease the temperature until we get to zero temperature.  The intuition here is that we end up in a deep minima.  In fact, you can show that (in some unrealistic cases where you cool very slowly) you are guaranteed to get a global minima.</p>
<p>The algorithm concretely is:</p>
<ul class="simple">
<li><p>Run Monte Carlo at high temperature <span class="math notranslate nohighlight">\(T\)</span> for a while</p></li>
<li><p>Every so often decrease the temperature</p></li>
<li><p>When you get to  <span class="math notranslate nohighlight">\(T=0\)</span> which is equivalent to our local optimization) stop after your optimization doesn’t go down any more.</p></li>
</ul>
<p>Now the only trick is to figure out what “temperature schedule” we want to use (i.e. how do we go from infinite temperature to zero). Let’s go ahead and run our optimization doing a couple different things:</p>
<ul class="simple">
<li><p>try a linear temperature schedule</p></li>
<li><p>try an exponential temperature schedule</p></li>
<li><p>try a logarithmic temperature schedule</p></li>
</ul>
<p>To have a fair test, use the same initial conditions and same values of <span class="math notranslate nohighlight">\(J\)</span>.</p>
<div class="caution admonition">
<p class="admonition-title">Grading</p>
<p>Now using the same random coupling constants as the <span class="math notranslate nohighlight">\(T=0\)</span> case, try to find a minima using simulated annealing with a couple different temperature schedules. You should produce a graph that shows:</p>
<ul class="simple">
<li><p>the average energy of the minima using local optimization</p></li>
<li><p>the lowest energy of the minima using local optimization</p></li>
<li><p>the different energies of minima you find using different simulated annealing temperature schedules. Good schedules to test are:</p>
<ul>
<li><p>linear decrease in temperature</p></li>
<li><p>logarithmic decrease in temperature</p></li>
<li><p>exponential decrease in temperature</p></li>
</ul>
</li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Extra Credit </p>
<p>Below is where you can get the extra <strong>+10 points</strong>.</p>
</div>
</div>
</div>
<div class="section" id="hp-model">
<h2>HP Model<a class="headerlink" href="#hp-model" title="Permalink to this headline">#</a></h2>
<p>The model that you just did simulated annealing with (random Ising model) is a spin glass. Is is interesting but it is not that often that you are trying to optimize a random spin glass.  Here we would like you to do simulated annealing on a more realistic model:  the HP-model for protein folding (see <a class="reference external" href="https://en.wikipedia.org/wiki/Hydrophobic-polar_protein_folding_model">https://en.wikipedia.org/wiki/Hydrophobic-polar_protein_folding_model</a>).</p>
<p>Here we would like you to minimize the energy of a given protein.  In particular, take a random length 30-string (of random H and P).  Then try to find the folding sequence (can be represented by a sequence of right, left, or straight turns) that produces the lowest energy of this model using simulated anneling.</p>
<p>All you need to do this is to be able to take this combination of turns and then return its energy.  Once you have that, you can write a Monte Carlo code and then use it as a simulated annealing.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Ising"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="ParallelTempering.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Extra Credit: Parallel Tempering</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../ML/Overview.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Overview</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Bryan Clark<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>